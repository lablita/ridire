<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                             "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.prime.com.tr/ui"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" template="layout/template.xhtml">

	<ui:define name="title">
  Sketch
</ui:define>

	<ui:define name="body">
		<h1>Sketch</h1>
		<h:form>
			<s:div id="lemmi">
				<h:panelGrid columns="4">
					<h:outputText value="Primo lemma: " />
					<h:inputText value="#{cwbSketchExtractor.firstWord}" />
					<h:outputText value="PoS: " />
					<h:selectOneMenu value="#{cwbSketchExtractor.firstPoS}">
						<f:selectItem itemValue="nome" />
						<f:selectItem itemValue="verbo" />
						<f:selectItem itemValue="aggettivo" />
						<f:selectItem itemValue="avverbio" />
						<a4j:support event="onchange" reRender="sketchChooser" />
					</h:selectOneMenu>
				</h:panelGrid>
				<h:panelGrid columns="4" id="secondLemma"
					style="display: #{cwbSketchExtractor.confSemantic or cwbSketchExtractor.confFunctional?'none':''};">
					<h:outputText value="Secondo lemma: " />
					<h:inputText value="#{cwbSketchExtractor.secondWord}" />
					<h:outputText value="PoS: " />
					<h:selectOneMenu value="#{cwbSketchExtractor.secondPoS}">
						<f:selectItem itemValue="nome" />
						<f:selectItem itemValue="verbo" />
						<f:selectItem itemValue="aggettivo" />
						<f:selectItem itemValue="avverbio" />
					</h:selectOneMenu>
				</h:panelGrid>
			</s:div>
			<h:panelGrid columns="2">
				<h:outputText value="Scegli sketch: " />
				<h:selectOneMenu value="#{cwbSketchExtractor.sketchToExtract}"
					id="sketchChooser">
					<f:selectItems var="sk" itemLabel="#{sk}"
						value="#{cwbSketchExtractor.goodSketches}" />
				</h:selectOneMenu>
			</h:panelGrid>
			<h:panelGrid columns="2">
				<h:outputText value="Misura:" />
				<h:selectOneRadio value="#{cwbSketchExtractor.score}">
					<s:selectItems var="tbv"
						value="#{cwbCollocatesExtractor.getAvailableScores()}"
						label="#{tbv}" />
				</h:selectOneRadio>
			</h:panelGrid>
			<h:panelGrid id="semDomain" columns="4"
				style="display: #{cwbSketchExtractor.confFunctional?'none':''};">
				<h:outputText value="Dom. semantico" />
				<h:selectOneMenu value="#{cwbSketchExtractor.semanticMetadatum}">
					<f:selectItems
						value="#{localResourcesManager.allSemanticMetadataMapPlusAll}" />
				</h:selectOneMenu>
				<h:outputText value="Confronto" />
				<h:selectBooleanCheckbox value="#{cwbSketchExtractor.confSemantic}">
					<a4j:support reRender="secondLemma,confDomain,functDomain"
						event="onclick" ajaxSingle="true" />
				</h:selectBooleanCheckbox>
			</h:panelGrid>
			<h:panelGrid id="functDomain" columns="4"
				style="display: #{cwbSketchExtractor.confSemantic?'none':''};">
				<h:outputText value="Dom. funzionale" />
				<h:selectOneMenu value="#{cwbSketchExtractor.functionalMetadatum}">
					<f:selectItems
						value="#{localResourcesManager.allFunctionalMetadataMapPlusAll}" />
				</h:selectOneMenu>
				<h:outputText value="Confronto" />
				<h:selectBooleanCheckbox
					value="#{cwbSketchExtractor.confFunctional}">
					<a4j:support reRender="secondLemma,confDomain,semDomain"
						event="onclick" ajaxSingle="true" />
				</h:selectBooleanCheckbox>
			</h:panelGrid>
			<h:panelGrid columns="2" id="confDomain"
				style="display: #{cwbSketchExtractor.confFunctional or cwbSketchExtractor.confSemantic?'':'none'};">
				<h:outputText value="Dom. confronto" />
				<h:selectOneMenu value="#{cwbSketchExtractor.secondMetadatum}">
					<f:selectItems value="#{localResourcesManager.allMetadataMap}" />
				</h:selectOneMenu>
			</h:panelGrid>
			<h:commandButton action="#{cwbSketchExtractor.extractSketches()}"
				value="Calcola sketch" />
			<br />
			<s:fragment
				rendered="#{not empty cwbSketchExtractor.firstWord and not empty cwbSketchExtractor.secondWord}">
				<rich:dataTable
					value="#{cwbSketchExtractor.chosenSketch.getSketchResultsCoupled('all')}"
					var="s2">
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{sketch.name}" />
						</f:facet>
						<h:outputText value="#{s2.term}" />
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<h:outputText value="Punteggio" />
						</f:facet>
						<h:outputText value="#{s2.firstWordScore-s2.secondWordScore}" />
					</rich:column>
				</rich:dataTable>
			</s:fragment>
			<s:fragment
				rendered="#{not empty cwbSketchExtractor.firstWord and empty cwbSketchExtractor.secondWord and (not cwbSketchExtractor.confSemantic and not cwbSketchExtractor.confFunctional)}">
				<rich:dataTable
					value="#{cwbSketchExtractor.chosenSketch.getOrderedSketchResults('all')}"
					var="s2">
					<rich:column>
						<f:facet name="header">
							<h:outputText value="#{sketch.name}" />
						</f:facet>
						<s:link value="#{s2.term}" view="/cwbconcordances.xhtml"
							action="#{cwbConcordancer.setResultsFromSketchExtracted(false)}">
							<f:param name="fromSketch" value="true" />
							<f:param name="sketchTerm" value="#{s2.term}" />
						</s:link>
					</rich:column>
					<rich:column>
						<f:facet name="header">
							<h:outputText value="Punteggio" />
						</f:facet>
						<h:outputText value="#{s2.firstWordScore}" />
					</rich:column>
				</rich:dataTable>
			</s:fragment>
			<s:fragment
				rendered="#{cwbSketchExtractor.confSemantic or cwbSketchExtractor.confFunctional}">
				<h:panelGrid columns="2">
					<h:outputText value="#{cwbSketchExtractor.firstDomain}"
						styleClass="domainHeader" />
					<h:outputText value="#{cwbSketchExtractor.secondDomain}"
						styleClass="domainHeader" />
					<rich:dataTable
						value="#{cwbSketchExtractor.chosenSketch.getTwoDomainsSketchResults(1)}"
						var="s2">
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{sketch.name}" />
							</f:facet>
							<h:outputText value="#{s2.term}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="Punteggio" />
							</f:facet>
							<h:outputText value="#{s2.firstWordScore - s2.secondWordScore}" />
						</rich:column>
					</rich:dataTable>
					<rich:dataTable
						value="#{cwbSketchExtractor.chosenSketch.getTwoDomainsSketchResults(2)}"
						var="s2">
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{sketch.name}" />
							</f:facet>
							<h:outputText value="#{s2.term}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="Punteggio" />
							</f:facet>
							<h:outputText value="#{s2.firstWordScore - s2.secondWordScore}" />
						</rich:column>
					</rich:dataTable>
				</h:panelGrid>
			</s:fragment>
		</h:form>
	</ui:define>

</ui:composition>

